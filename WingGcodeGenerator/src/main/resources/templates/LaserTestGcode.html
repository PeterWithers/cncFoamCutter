<!DOCTYPE html>
<!--
Copyright (C) 2017 Peter Withers
-->

<!--
 * @since Dec 20, 2017 19:45 PM (creation date)
 * @author <peter-gthb@bambooradical.com>
-->
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
    <head>
        <title>Laser Test GCODE</title>
        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <style th:include="WingDesignView :: stylesection"></style>        
    </head> 
    <body>
        <div id="menu" style="position: fixed; top: 5px;">
            <a href='#editSvgPanel'>Preview</a>
            <a href='#gcode'>View GCODE</a>
            <a th:href="${'data:text/plain;charset=utf-8,'+laserTestGcodeData.getGcode()}" th:attr="download=${laserTestGcodeData.minPower+'-'+laserTestGcodeData.maxPower+'_'+laserTestGcodeData.minSpeed+'-'+laserTestGcodeData.maxSpeed+'.gcode'}">Download GCODE</a>
        </div>
        <br/>
        <br/>
        <div th:fragment="propEditor">
            <div id="editorForm">
                <form method="POST" action="#" th:action="@{/LaserTestGcode}" th:object="${laserTestGcodeData}">    
                    Grid Size <input type="number" th:field="*{gridSize}" />
                    Line Spacing <input type="number" th:field="*{lineSpacing}" />
                    Line Steps <input type="number" th:field="*{lineSteps}" /><br/><br/>
                    Line Zigzag <input type="number" th:field="*{lineZigzag}" /><br/><br/>
                    Fly Speed <input type="number" th:field="*{flySpeed}" /><br/><br/>
                    Minimum Power <input type="number" th:field="*{minPower}" />
                    Maximum Power <input type="number" th:field="*{maxPower}" /><br/><br/>
                    Minimum Speed <input type="number" th:field="*{minSpeed}" />
                    Maximum Speed <input type="number" th:field="*{maxSpeed}" /><br/><br/>
                    <button type="submit" id="saveButton" >Update</button>
                </form>
            </div>            
            <svg id="editSvgPanel" viewBox="-25 -50 150 100">
                <g id="grid">
                    <line th:each="yRow : ${#numbers.sequence( -50, 50)}" x1="0" th:attr="y1=${yRow}, y2=${yRow}" x2="100" style="stroke:rgba(50,50,50, 150);stroke-width:0.1" />
                    <line th:each="yRow : ${#numbers.sequence( -5, 5)}" x1="-5" th:attr="y1=${yRow*10}, y2=${yRow*10}" x2="105" style="stroke:rgba(100,100,100, 150);stroke-width:0.1" />
                    <line th:each="xRow : ${#numbers.sequence( 0, 100)}" y1="-50" th:attr="x1=${xRow}, x2=${xRow}" y2="50" style="stroke:rgba(50,50,50, 150);stroke-width:0.1" />
                    <line th:each="xRow : ${#numbers.sequence( 0, 10)}" y1="-55" th:attr="x1=${xRow*10}, x2=${xRow*10}" y2="55" style="stroke:rgba(100,100,100, 150);stroke-width:0.1" />
                </g>
                <!--<path class="aerofoilEditLines" id="extrusionPath" th:attr="d=${laserTestGcodeData.getSvgPoints()}"/>-->
                <g transform="translate(20, -30)">
                    <path th:each="pathString, iterator : ${laserTestGcodeData.getSvgPoints()}" th:class="${laserTestGcodeData.getSvgPointsClass(iterator.index, iterator.size)}" th:attr="d=${pathString}">
                        <animate th:if="${iterator.index} eq 0" attributeName="stroke-dashoffset" from="1000" to="0" begin="1s" dur="2s" repeatCount="indefinite" />
                    </path>
                </g>
            </svg>   
            <br/>
            <pre id="gcode" th:text="${laserTestGcodeData.getGcode()}"></pre>
        </div>
    </body>
</html>
